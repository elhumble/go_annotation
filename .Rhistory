goSlim <- read.table("joined_transcriptome_SLIM.gaf", header = T)
?read.table
goSlim <- readLines("joined_transcriptome_SLIM.gaf", n = 6)
head(goSlim)
goSlim <- readLines("joined_transcriptome_SLIM.gaf")
head(goSlim)
tail(goSlim)
setwd("~/Downloads/Dryad Data/go_files")
gene.annotations <- c(readLines("gene_association.goa_human"),
readLines("gene_association_mouse"),
readLines("gene_association_rat"),
readLines("gene_association_zebrafish"))
head(gene.annotations)
goLines <- NULL
for(i in geneIDs) goLines <- c(goLines, gene.annotations[grep(i, gene.annotations, ignore.case=T)])
geneIDs <- c("chmp3", "ckb", "ckm", "ezr", "H3", "itpk1", "klc", "lypla", "mhc2", "hla", "stk16", "tuba", "uchl", "ypel5")
for(i in geneIDs) goLines <- c(goLines, gene.annotations[grep(i, gene.annotations, ignore.case=T)])
setwd("~/Dropbox/PhD/Projects/Paper2_SNPdetection/go_annotation/map2slim")
for(i in geneIDs) goLines <- c(goLines, gene.annotations[grep(i, gene.annotations, ignore.case=T)])
head(geneIDs)
head(goLines)
length(strsplit(goLines[1], split = "\t")[[1]])
goTable <- matrix(ncol = 17,
nrow = length(goLines))
head(goTable)
for(i in 1:length(goLines)) goTable[i,1:length(strsplit(goLines[i], split = "\t")[[1]])] <- strsplit(goLines[i], split = "\t")[[1]]
head(goTable)
length(strsplit(goSlim[1], split = "\t")[[1]])
head(goSlim)
goSlim <- readLines("joined_transcriptome_SLIM.gaf", skip = 5)
head(goSlim)
str(goSlim)
goSlim <- readLines("joined_transcriptome_SLIM.gaf", n = -5)
head(goSlim)
goSlim <- readLines("joined_transcriptome_SLIM.gaf", n = 7)
head(goSlim)
goSlim <- goSlim[-1]
head(goSlim)
goSlim <- readLines("joined_transcriptome_SLIM.gaf")
goSlim <- goSlim[-5]
head(goSlim)
goSlim <- readLines("joined_transcriptome_SLIM.gaf")
goSlim <- goSlim[-1:5]
goSlim <- readLines("joined_transcriptome_SLIM.gaf")
goSlim <- goSlim[-c(1:5)]
head(goSlim)
length(strsplit(goSlim[1], split = "\t")[[1]])
goTable <- matrix(ncol = 16,
nrow = length(goSlim))
head(goTable)
for(i in 1:length(goSlim)) goTable[i,1:length(strsplit(goSlim[i], split = "\t")[[1]])] <- strsplit(goSlim[i], split = "\t")[[1]]
head(goTable)
goTable <- matrix(ncol = 17,
nrow = length(goLines))
for(i in 1:length(goLines)) goTable[i,1:length(strsplit(goLines[i], split = "\t")[[1]])] <- strsplit(goLines[i], split = "\t")[[1]]
head(goTable)
goTable <- data.frame(goTable)
head(goTable)
goTable <- matrix(ncol = 16,
nrow = length(goSlim))
head(goTable)
for(i in 1:length(goSlim)) goTable[i,1:length(strsplit(goSlim[i], split = "\t")[[1]])] <- strsplit(goSlim[i], split = "\t")[[1]]
head(goTable)
goTable <- goTable[c(3,5),]
head(goTable)
for(i in 1:length(goSlim)) goTable[i,1:length(strsplit(goSlim[i], split = "\t")[[1]])] <- strsplit(goSlim[i], split = "\t")[[1]]
goTable <- matrix(ncol = 16,
nrow = length(goSlim))
for(i in 1:length(goSlim)) goTable[i,1:length(strsplit(goSlim[i], split = "\t")[[1]])] <- strsplit(goSlim[i], split = "\t")[[1]]
goTable <- goTable[,c(3,5)]
head(goTable)
goTable <- data.frame(goTable)
head(goTable)
names(goTable) <- c("Contig_Name", "goSlimTerm")
head(goTable)
names <- read.table("goslim/goslim_generic.txt")
names <- readLines("goslim/goslim_generic.txt")
head(names)
names <- read.table("goslim/goslim_generic.txt", sep = "\t")
head(names)
goSlim <- read.table("joined_transcriptome_SLIM.gaf", sep = "\t")
head(goSlim)
tail(goSlim)
names <- read.table("goslim/goslim_generic.txt", sep = "\t", col.names = c("goSlimTerm", "name")) %>%
right_join(goTable, by = "goSlimTerm")
require(dplyr)
names <- read.table("goslim/goslim_generic.txt", sep = "\t", col.names = c("goSlimTerm", "name")) %>%
right_join(goTable, by = "goSlimTerm")
head(names)
length(naems)
View(names)
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)
head(snps)
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2]
head(snps)
goSlim <- readLines("joined_transcriptome_SLIM.gaf")[-c(1:5)]
head(goSlim)
tail(goTable)
tail(snps)
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>%
left_join(goTable, by = "Contig_Name")
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>%
right_join(goTable, by = "Contig_Name")
head(snps)
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>%
semi_join(goTable, by = "Contig_Name")
head(snps)
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% #34,718
left_join(goTable, by = "Contig_Name")
head(snps)
head(goTable)
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% #34,718
right_join(goTable, by = "Contig_Name")
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2]
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% # 34,718 snps
left_join(goTable, by = "Contig_Name")
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% # 34,718 snps
inner_join(goTable, by = "Contig_Name")
head(snps)
goSlim <- readLines("joined_transcriptome_SLIM.gaf")[-c(1:5)]
length(strsplit(goSlim[1], split = "\t")[[1]])
goTable <- matrix(ncol = 16,
nrow = length(goSlim))
# fill table
for(i in 1:length(goSlim)) goTable[i,1:length(strsplit(goSlim[i], split = "\t")[[1]])] <- strsplit(goSlim[i], split = "\t")[[1]]
goTable <- goTable[,c(3,5)] # retain contig and GO term
# make df
goTable <- data.frame(goTable)
names(goTable) <- c("Contig_Name", "goSlimTerm")
#combine with goSlim names
names <- read.table("goslim/goslim_generic.txt", sep = "\t", col.names = c("goSlimTerm", "name")) %>%
right_join(goTable, by = "goSlimTerm")
# merge with SNPs
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% # 34,718 snps
inner_join(goTable, by = "Contig_Name")
head(snps)
names <- read.table("goslim/goslim_generic.txt", sep = "\t", col.names = c("goSlimTerm", "name")) %>%
right_join(goTable, by = "goSlimTerm")
head(names)
View(names)
names <- read.table("goslim/goslim_generic.txt", sep = "\t", col.names = c("goSlimTerm", "name")) %>%
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% # 34,718 snps
left_join(goTable, by = "Contig_Name")
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% # 34,718 snps
left_join(goTable, by = "Contig_Name")
tail(snps)
View(snps)
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2]
View(snps)
View(names)
names <- read.table("goslim/goslim_generic.txt", sep = "\t", col.names = c("goSlimTerm", "name")) %>%
left_join(goTable, by = "goSlimTerm")
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% # 34,718 snps
left_join(goTable, by = "Contig_Name")
head(goTable)
goSlim <- readLines("joined_transcriptome_SLIM.gaf")[-c(1:5)]
length(strsplit(goSlim[1], split = "\t")[[1]])
goTable <- matrix(ncol = 16,
nrow = length(goSlim))
for(i in 1:length(goSlim)) goTable[i,1:length(strsplit(goSlim[i], split = "\t")[[1]])] <- strsplit(goSlim[i], split = "\t")[[1]]
goTable <- goTable[,c(3,5)] # retain contig and GO term
goTable <- data.frame(goTable)
names(goTable) <- c("Contig_Name", "goSlimTerm")
names <- read.table("goslim/goslim_generic.txt", sep = "\t", col.names = c("goSlimTerm", "name"))
head(names)
head(goTable)
names <- read.table("goslim/goslim_generic.txt", sep = "\t", col.names = c("goSlimTerm", "name")) %>%
right_join(goTable, by = "goSlimTerm")
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% # 34,718 snps
left_join(names, by = "Contig_Name")
head(names)
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2]
head(snps)
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% # 34,718 snps
right_join(names, by = "Contig_Name")
head(names)
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2]
head(snps)
View(names)
?merge
snps_full <- merge(snps, names, by.x = ("Contig_Name"))
snps_full <- merge(snps, names, by.y = ("Contig_Name"))
snps_full <- merge(snps, names, all.x = T, by = ("Contig_Name"))
snps_full <- merge(snps, names, all.x = T, by = "Contig_Name")
snps_full <- merge(snps, names, all.x = T, by.x = "Contig_Name")
snps_full <- merge(snps, names, all.x = F, by.x = "Contig_Name")
snps_full <- merge(snps, names, by.x = "Contig_Name")
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2]
snps_full <- merge(names, snps, by.x = "Contig_Name")
snps_full <- merge(names, snps, by = "Contig_Name")
snps_full <- merge(snps, names, by = "Contig_Name")
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% # 34,718 snps
right_join(names, by = "Contig_Name")
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% # 34,718 snps
left_join(names, by = "Contig_Name")
names <- read.table("goslim/goslim_generic.txt", sep = "\t", col.names = c("goSlimTerm", "name")) %>%
inner_join(goTable, by = "goSlimTerm")
names <- read.table("goslim/goslim_generic.txt", sep = "\t", col.names = c("goSlimTerm", "name")) %>%
full_join(goTable, by = "goSlimTerm")
names <- read.table("goslim/goslim_generic.txt", sep = "\t", col.names = c("goSlimTerm", "name")) %>%
right_join(goTable, by = "goSlimTerm")
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% # 34,718 snps
full_join(names, by = "Contig_Name")
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% # 34,718 snps
inner_join(names, by = "Contig_Name")
View(snps)
View(names)
View(goTable)
goSlim <- readLines("joined_transcriptome_SLIM.gaf")[-c(1:5)] # 24029 annotated contigs
length(strsplit(goSlim[1], split = "\t")[[1]])
goTable <- matrix(ncol = 16,
nrow = length(goSlim))
# fill table
for(i in 1:length(goSlim)) goTable[i,1:length(strsplit(goSlim[i], split = "\t")[[1]])] <- strsplit(goSlim[i], split = "\t")[[1]]
goTable <- goTable[,c(3,5)] # retain contig and GO term
# make df
goTable <- data.frame(goTable)
names(goTable) <- c("Contig_Name", "goSlimTerm")
names <- read.table("goslim/goslim_generic.txt", sep = "\t", col.names = c("goSlimTerm", "name"))
View(names)
View(goTable)
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% # 34,718 snps
left_join(names, by = "Contig_Name")
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% # 34,718 snps
left_join(names, by = "Contig_Name")
names <- read.table("goslim/goslim_generic.txt", sep = "\t", col.names = c("goSlimTerm", "name")) %>%
right_join(goTable, by = "goSlimTerm")
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% # 34,718 snps
left_join(names, by = "Contig_Name")
head(snps)
ddply(snps, "Contig_Name", summarize, goSlimTerm = paste(goSlimTerm, collapse=" "))
require(plyr)
ddply(snps, "Contig_Name", summarize, goSlimTerm = paste(goSlimTerm, collapse=" "))
snps2 <- ddply(snps, "Contig_Name", summarize, goSlimTerm = paste(goSlimTerm, collapse=" "))
head(snps2)
head(snps)
names <- read.table("goslim/goslim_generic.txt", sep = "\t", col.names = c("goSlimTerm", "name"))
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% # 34,718 snps
left_join(names, by = "Contig_Name")
head(names)
head(goTable)
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% # 34,718 snps
left_join(goTable, by = "Contig_Name")
snps2 <- ddply(snps, "Contig_Name", summarize, goSlimTerm = paste(goSlimTerm, collapse=" "))
head(snps2)
head(snps)
head(snps)
length(unique(snps$Contig_Name))
?summarize
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% # 34,718 snps
left_join(names, by = "Contig_Name")
names <- read.table("goslim/goslim_generic.txt", sep = "\t", col.names = c("goSlimTerm", "name")) %>%
right_join(goTable, by = "goSlimTerm")
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% # 34,718 snps
left_join(names, by = "Contig_Name")
snps2 <- ddply(snps, "Contig_Name", summarize, goSlimTerm = paste(goSlimTerm, collapse=" "), name = paste(name, collapse = " "))
head(snps2)
head(snps)
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% # 34,718 snps
left_join(names, by = "Contig_Name") %>%
mutate(Contig_Name = paste(Contig_Name, SNP_Position))
head(snps)
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% # 34,718 snps
left_join(names, by = "Contig_Name") %>%
mutate(Contig_Name = paste(Contig_Name, SNP_Position), sep="_")
rm(snps_full)
rm(snps_2)
rm(snps2)
snps <- ddply(snps, "Contig_Name", summarize, goSlimTerm = paste(goSlimTerm, collapse=" "), name = paste(name, collapse = " "))
head(snps)
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% # 34,718 snps
left_join(names, by = "Contig_Name") %>%
mutate(Contig_Name = paste(Contig_Name, SNP_Position sep="_"))
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% # 34,718 snps
left_join(names, by = "Contig_Name") %>%
mutate(Contig_Name = paste(Contig_Name, SNP_Position, sep="_"))
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% # 34,718 snps
left_join(names, by = "Contig_Name") %>%
mutate(Contig_Name = paste(Contig_Name, SNP_Position, sep="_")) %>%
ddply(Contig_Name, summarize, goSlimTerm = paste(goSlimTerm, collapse=" "), name = paste(name, collapse = " "))
snps <- read.csv("../../snp_filtering_pipeline/data/processed/global_snps_hq.csv", header = T)[,1:2] %>% # 34,718 snps
left_join(names, by = "Contig_Name") %>%
mutate(Contig_Name = paste(Contig_Name, SNP_Position, sep="_")) %>%
ddply("Contig_Name", summarize, goSlimTerm = paste(goSlimTerm, collapse=" "), name = paste(name, collapse = " "))
head(snps)
View(snps)
immune <- "immune"
immune
annotation <- readLines("../joined_transcriptome_ANNOTATED.txt")[-c(1,15,19)] # 24029 annotated contigs
immune <- "immune"
immuneLines <- NULL
for(i in immune) immuneLines <- c(goLines, annotation[grep(i, annotation, ignore.case=T)])
head(immuneLines)
for(i in immune) immuneLines <- c(immuneLines, annotation[grep(i, annotation, ignore.case=T)])
head(immuneLines)
annotation <- readLines("../joined_transcriptome_ANNOTATED.txt")[-c(1,15,19)]
immune <- "immune"
immuneLines <- NULL
for(i in immune) immuneLines <- c(immuneLines, annotation[grep(i, annotation, ignore.case=T)])
head(immuneLines)
head(annotation)
annotation <- readLines("../joined_transcriptome_ANNOTATED.txt")
head(annotation)
annotation <- readLines("../joined_transcriptome_ANNOTATED.txt")[-c(1,14,18)]
head(annotation)
immune <- "immune"
immuneLines <- NULL
for(i in immune) immuneLines <- c(immuneLines, annotation[grep(i, annotation, ignore.case=T)])
head(immuneLines)
length(strsplit(immuneLines[1], split = "\t")[[1]])
immuneTable <- matrix(ncol = 18,
nrow = length(immuneLines))
for(i in 1:length(immuneLines)) goTable[i,1:length(strsplit(immuneLines[i], split = "\t")[[1]])] <- strsplit(immuneLines[i], split = "\t")[[1]]
head(immuneLines)
annotation <- readLines("../joined_transcriptome_ANNOTATED.txt")[-c(1,14,18)]
immune <- "immune"
immuneLines <- NULL
for(i in immune) immuneLines <- c(immuneLines, annotation[grep(i, annotation, ignore.case=T)])
length(strsplit(immuneLines[1], split = "\t")[[1]])
immuneTable <- matrix(ncol = 18,
nrow = length(immuneLines))
head(immuneTable)
for(i in 1:length(immuneLines)) immuneTable[i,1:length(strsplit(immuneLines[i], split = "\t")[[1]])] <- strsplit(immuneLines[i], split = "\t")[[1]]
head(immuneTable)
head(immuneTable)
annotation <- readLines("../joined_transcriptome_ANNOTATED.txt")[-c(1,14,18)]
immune <- "immune"
immuneLines <- NULL
for(i in immune) immuneLines <- c(immuneLines, annotation[grep(i, annotation, ignore.case=T)])
length(strsplit(immuneLines[1], split = "\t")[[1]])
immuneTable <- matrix(ncol = 18,
nrow = length(immuneLines))
for(i in 1:length(immuneLines)) immuneTable[i,1:length(strsplit(immuneLines[i], split = "\t")[[1]])] <- strsplit(immuneLines[i], split = "\t")[[1]]
head(immuneTable)
annotation <- readLines("../joined_transcriptome_ANNOTATED.txt")[-c(1,14,18)]
head(annotation)
annotation <- read.table("../joined_transcriptome_ANNOTATED.txt")
annotation <- read.table("../joined_transcriptome_ANNOTATED.txt", header = T, sep = "/t")
annotation <- read.table("../joined_transcriptome_ANNOTATED.txt", header = T, sep = "\t")
head(annotation)
annotation <- readLines("../joined_transcriptome_ANNOTATED.txt")
immune <- "immune"
immuneLines <- NULL
for(i in immune) immuneLines <- c(immuneLines, annotation[grep(i, annotation, ignore.case=T)])
length(strsplit(immuneLines[1], split = "\t")[[1]])
nrow = length(immuneLines))
immuneTable <- matrix(ncol = 18,
for(i in 1:length(immuneLines)) immuneTable[i,1:length(strsplit(immuneLines[i], split = "\t")[[1]])] <- strsplit(immuneLines[i], split = "\t")[[1]]
)
annotation <- readLines("../joined_transcriptome_ANNOTATED.txt")
immune <- "immune"
immuneLines <- NULL
for(i in immune) immuneLines <- c(immuneLines, annotation[grep(i, annotation, ignore.case=T)])
length(strsplit(immuneLines[1], split = "\t")[[1]])
immuneTable <- matrix(ncol = 18,
nrow = length(immuneLines))
for(i in 1:length(immuneLines)) immuneTable[i,1:length(strsplit(immuneLines[i], split = "\t")[[1]])] <- strsplit(immuneLines[i], split = "\t")[[1]]
immuneTable <- data.frame(immuneTable)
head(immuneTable)
annotation <- readLines("../joined_transcriptome_ANNOTATED.txt")
immune <- "immune"
immuneLines <- NULL
for(i in immune) immuneLines <- c(immuneLines, annotation[grep(i, annotation, ignore.case=T)])
length(strsplit(immuneLines[1], split = "\t")[[1]])
immuneTable <- matrix(ncol = 18,
nrow = length(immuneLines))
head(immuneTable)
head(immuneLines)
for(i in 1:length(immuneLines)) immuneTable[i,1:length(strsplit(immuneLines[i], split = "\t")[[1]])] <- strsplit(immuneLines[i], split = "\t")[[1]]
head(immuneTable)
immuneTable <- data.frame(immuneTable)
head(immuneTable)
View(immuneTable)
immuneTable <- data.frame(immuneTable)[,c(1,14,18)]
head(immuneTable)
View(immuneTable)
length(unique(immuneTable$X1))
View(immuneTable)
immune <- "immun"
immuneLines <- NULL
for(i in immune) immuneLines <- c(immuneLines, annotation[grep(i, annotation, ignore.case=T)])
length(strsplit(immuneLines[1], split = "\t")[[1]])
immuneTable <- matrix(ncol = 18,
nrow = length(immuneLines))
# fill table
for(i in 1:length(immuneLines)) immuneTable[i,1:length(strsplit(immuneLines[i], split = "\t")[[1]])] <- strsplit(immuneLines[i], split = "\t")[[1]]
immuneTable <- data.frame(immuneTable)[,c(1,14,18)]
length(unique(immuneTable$X1))
